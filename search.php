<?php//データベース情報の指定$db[ 'dbname' ] = "heroku_921e62bfdd3a5fd"; // データベース名$db[ 'user' ] = "bf76585b664e5b"; // ユーザー名$db[ 'pass' ] = "e925f993"; // ユーザー名のパスワード$db[ 'host' ] = "us-cdbr-east-04.cleardb.com"; // DBサーバのURL//エラーメッセージの初期化$errorMessage = "";//フラグの初期化$o = false;//検索ボタンが押された時の処理if ( isset( $_POST[ "search" ] ) ) {	//入力チェック	if ( empty( $_POST[ "textbox" ] ) ) {		$errorMessage = '未入力です。';	}	if ( !empty( $_POST[ "textbox" ] ) ) {		$o = true;		//入力した文字を変数に格納		$textbox = $_POST[ "textbox" ];		$textboxs = explode( " ", mb_convert_kana( $textbox, 's' ) );		$operator_in = $_POST[ "operator_in" ];		$operator_like = $_POST[ "operator_like" ];		$selectbox = $_POST[ "selectbox" ];		//dsnを作成		$dsn = sprintf( 'mysql:host=%s; dbname=%s; charset=utf8', $db[ 'host' ], $db[ 'dbname' ] );		try {			//PDOを使ってMySQLに接続			$pdo = new PDO( $dsn, $db[ 'user' ], $db[ 'pass' ], array( PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION ) );			//SQLを作成			if ( $operator_like == 'like' ) {				if ( $operator_in == 'in' ) {					foreach ( $textboxs as $textbox ) {						$textboxCondition[] = "(" . $selectbox . " LIKE ?)";						$values[] = '%' . preg_replace( '/(?=[!_%])/', '', $textbox ) . '%';					}					$textboxCondition = implode( ' OR ', $textboxCondition );				} else {					$textboxCondition[] = "(" . $selectbox . " LIKE ?)";					$values[] = '%' . preg_replace( '/(?=[!_%])/', '', $textbox ) . '%';					$textboxCondition = implode( ' OR ', $textboxCondition );				}				$sql = "SELECT * FROM property WHERE $textboxCondition";			} else {				if ( $operator_in == 'in' ) {					$place_holders = implode( ',', array_fill( 0, count( $textboxs ), '?' ) );					$sql = "SELECT * FROM property WHERE $selectbox IN ($place_holders)";				} else {					$sql = "SELECT * FROM property WHERE $selectbox = ?";				}			}			$stmt = $pdo->prepare( $sql );			if ( $operator_like == 'like' ) {				$stmt->execute( $values );			} else {				if ( $operator_in == 'in' ) {					$stmt->execute( $textboxs );				} else {					$stmt->execute( array( $textbox ) );				}			}		} catch ( PDOException $e ) {			$errorMessage = 'データベースエラー';		}	}}?>